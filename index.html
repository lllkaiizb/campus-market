<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>校园二手市场展示</title>
  <style>
    .product { border: 1px solid #ccc; margin: 10px; padding: 10px; }
    .product img { max-width: 150px; display: block; margin-bottom: 5px; }
  </style>
</head>
<body>
  <h1>商品展示</h1>
  <div id="products">正在加载商品…</div>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbyt40b0QbX-DSnP4xwZjiS6tMgKM2gSNBE066vRb3jCWWfsU4YGuxbl6C0DT98PuveA/exec";

    async function loadProducts() {
      try {
        const res = await fetch(API_URL);
        const result = await res.json();
        const container = document.getElementById("products");
        container.innerHTML = "";  // 清空加载中的文字

        if (result.success && result.products.length > 0) {
          result.products.forEach(p => {
            const div = document.createElement("div");
            div.className = "product";
            div.innerHTML = `
              <h3>${p.name}</h3>
              <p>${p.description}</p>
              ${p.image ? `<img src="${p.image}" alt="${p.name}">` : ""}
              <p>价格: ${p.price}</p>
              <p>联系方式: ${p.contact}</p>
              <p>地点: ${p.location}</p>
            `;
            container.appendChild(div);
          });
        } else {
          container.textContent = "目前没有商品展示。";
        }
      } catch (err) {
        document.getElementById("products").textContent = "加载商品失败：" + err;
      }
    }

    loadProducts();
  </script>
</body>
</html>
